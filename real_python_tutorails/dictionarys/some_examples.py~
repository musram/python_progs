#https://realpython.com/python-defaultdict/#handling-missing-keys-in-dictionaries


if __name__ == "__main__":
    d = {}

    #handling missing keys
    #(1) setdefault
    """
    setdefault(key[, default])

    If key is in the dictionary, return its value. If not, insert key with a value of default and return default. default defaults to None.
     """
    default = d.setdefault('misssing_key', 'default_value')
    print(default)

    print(d['misssing_key'])


    """
    (2) get(key[, default])

    Return the value for key if key is in the dictionary, else default. If default is not given, it defaults to None, so that this method never raises a KeyError

    """
    d = {}
    default = d.get('missing_key', 'default value')
    print(default)
    print(d)

    #(3) in method

    d = {}
    if 'key' in d:
        print(d['key'])
    else:
        d['key'] = 'default_value'

    print(d)

    #(4) try except

    try:
        print(d['key'])
    except KeyError as e:
        d['key'] = 'default_value'

    print(d)


    

    #defaultdict

    from collections import defaultdict

    print(issubclass(defaultdict, dict))

    print(set(dir(defaultdict)) - set(dir(dict)))
    
    std_dict = dict(numbers=[1, 2, 3], letters=['a', 'b', 'c'])

    def_dict = defaultdict(list, numbers=[1, 2, 3], letters=['a', 'b', 'c'])

    print(std_dict == def_dict)

    #The first argument to the Python defaultdict type must be a callable that takes no arguments and returns a value. This argument is assigned to the instance attribute, .default_factory.

    dd = defaultdict(list, letters=['a', 'b', 'c'])

    print(dd.default_factory)

    print(dd)

    print(dd['missing_key'])

    dd['missing_key'].append(1)

    print(dd)

    dd['letters'] += [2,3]

    print(dd)

    """
    Keep in mind that .default_factory is only called from .__getitem__() and not from other methods. This means that if dd is a defaultdict and key is a missing key, then dd[key] will call .default_factory to provide a default value, but dd.get(key) still returns None instead of the value that .default_factory would provide. Thats because .get() doesnt call .__getitem__() to retrieve the key
    """

    dd = defaultdict(list)

    print(dd['missing'])

    print(dd.get('another_missing'))  #doesnot call __getitem__

    print(dd)

    #change or update the callable

    dd.default_factory = str
    print(dd['missing_key'])
    print(dd)

    """
    At this point, you may have an idea of when to use a defaultdict rather than a regular dict. Here are three things to take into account:

If your code is heavily base on dictionaries and youre dealing with missing keys all the time, then you should consider using a defaultdict rather than a regular dict.

If your dictionary items need to be initialized with a constant default value, then you should consider using a defaultdict instead of a dict.

If your code relies on dictionaries for aggregating, accumulating, counting, or grouping values, and performance is a concern, then you should consider using a defaultdict.
    """

